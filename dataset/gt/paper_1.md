

# 图13  PSO流程图

PSO 中每次迭代粒子 i 的速度 $v_{i}$，和位置 $x_{i}$，更新公式为：

$\nu_{i}^{k}=w\nu_{i}^{k-1}+c_{1}r_{1}^{*}rand()^{*}(pbest_{i}-x_{i}^{k-1})+c_{2}r_{2}^{*}rand()^{*}(gbest-x_{i}^{k-1})$

$x_{i}^{k}=x_{i}^{k-1}+\nu_{i}^{k}$

其中，w为惯性权重（inertia weight），c1和c2为加速常数（acceleration constants），rand()为在[0,1]范围里变化的随机值，pbest为粒子自身的最佳过去位置，gbest为整个群或近邻的最佳过去位置。

采用粒子群算法优化随机森林模型的参数，可以将模型返回预测结果计算得到的F1值作为目标函数，通过更新迭代得到最佳位置，即最优参数。

本项目中，在采用粒子群算法的基础上，还引入了惯性权重线性递减和多样性维护参数的概念，对算法加以改进。其中惯性权重w线性递减，根据迭代进度，逐渐减小惯性权重，可以在一定程度上优化粒子的寻优能力；多样性维护参数 c3 可以确保种群中的粒子保持一定的多样性，避免陷入局部最优解。

$w=w_{\max}-\frac{t}{T}\left(w_{\max}-w_{\min}\right)$

$V=c_3^*(Rand()-0.5)^*range$

$\nu_{i}^{k}=\nu_{i}^{k}+V$

其中，$w_{\max}=0.9$，$w_{\min}=0.4$，t 为当前迭代次数，T 为最大迭代次数，$c_{3}=0.1$，V为多样性维护项，range为各参数取值范围长度。

