<!-- 初始化粒子 的速度和位置 计算粒子适应度 获取个体最优位置 和全局最优位置 更新粒子速度和位置 N 是否输出 结束  -->

图13 PSO流程图

PSO中每次迭代粒子i的速度$v _ { i }$和位置$x _ { i }$更新公式为：

$v _ { t } ^ { k } = m v _ { t } ^ { k - 1 } + c _ { t 1 } r _ { t 1 } ^ { * } r a m d 0 ^ { * } ( p b e s t _ { t } - x _ { t } ^ { k - 1 } ) + c _ { 2 } r _ { 2 } ^ { * * } r a n d 0 ^ { * } ( g b$

$x _ { i } ^ { k } = x _ { i } ^ { k - 1 } + v _ { i } ^ { k }$

其中，w为惯性权重（inertia weight），$c _ { 1 }$和$c _ { 2 }$为加速常数（acceleration constants），rand(为在［0,1］范围里变化的随机值，pbest为粒子自身的最佳过去位置，gbest为整个群或近邻的最佳过去位置。

采用粒子群算法优化随机森林模型的参数，可以将模型返回预测结果计算得到的F1值作为目标函数，通过更新迭代得到最佳位置，即最优参数。

本项目中，在采用粒子群算法的基础上，还引入了惯性权重线性递减和多样性维护参数的概念，对算法加以改进。其中惯性权重w线性递减，根据迭代进度，逐渐减小惯性权重，可以在一定程度上优化粒子的寻优能力；多样性维护参数$c _ { 3 }$可以确保种群中的粒子保持一定的多样性，避免陷入局部最优解。

$w = w _ { \max } - \frac { t } { T } ( w _ { \max } - w _ { \min } )$

$V = c _ { 3 } ^ { * } ( R a n d 0 - 0 . 5 ) ^ { * } r a n g e$

$v _ { i } ^ { k } = v _ { i } ^ { k } + V$

其中， $w _ { \max } = 0 . 9$, $w _ { \min } = 0 . 4$，t为当前迭代次数，T为最大迭代次数， $c _ { 3 } = 0 . 1$,V 为多样性维护项，range为各参数取值范围长度。


